{
  "schemaVersion": "ruleset-v1",
  "rulesetId": "default-v1",
  "name": "기본 룰셋 (데모/PoC용)",
  "description": "content.js에서 발생하는 이벤트(type/data)를 기준으로 ruleId/scoreDelta/severity를 정책(룰셋)으로 정의합니다.",
  "enabled": true,
  "updatedAt": "2025-12-26",

  "rules": [
    {
      "id": "SENSOR_READY",
      "enabled": true,
      "when": { "type": "SENSOR_READY" },
      "action": {
        "ruleId": "SENSOR_READY",
        "scoreDelta": 0,
        "severity": "LOW"
      }
    },

    {
      "id": "DYN_SCRIPT_INSERT_CROSS_SITE",
      "enabled": true,
      "when": {
        "type": "DYN_SCRIPT_INSERT",
        "equals": { "crossSite": true }
      },
      "action": {
        "ruleId": "DYN_SCRIPT_INSERT_CROSS_SITE",
        "scoreDelta": 20,
        "severity": "MEDIUM"
      }
    },
    {
      "id": "DYN_SCRIPT_INSERT_SAME_SITE",
      "enabled": true,
      "when": {
        "type": "DYN_SCRIPT_INSERT",
        "equals": { "crossSite": false }
      },
      "action": {
        "ruleId": "DYN_SCRIPT_INSERT_SAME_SITE",
        "scoreDelta": 5,
        "severity": "LOW"
      }
    },

    {
      "id": "HIDDEN_IFRAME_INSERT",
      "enabled": true,
      "when": {
        "type": "DYN_IFRAME_INSERT",
        "equals": { "hidden": true }
      },
      "action": {
        "ruleId": "HIDDEN_IFRAME_INSERT",
        "scoreDelta": 35,
        "severity": "HIGH"
      }
    },
    {
      "id": "IFRAME_INSERT",
      "enabled": true,
      "when": {
        "type": "DYN_IFRAME_INSERT",
        "equals": { "hidden": false }
      },
      "action": {
        "ruleId": "IFRAME_INSERT",
        "scoreDelta": 10,
        "severity": "LOW"
      }
    },

    {
      "id": "PHISHING_FORM_MISMATCH",
      "enabled": true,
      "when": {
        "type": "FORM_SUBMIT",
        "equals": { "mismatch": true }
      },
      "action": {
        "ruleId": "PHISHING_FORM_MISMATCH",
        "scoreDelta": 50,
        "severity": "HIGH"
      }
    },
    {
      "id": "FORM_ACTION_MATCH",
      "enabled": true,
      "when": {
        "type": "FORM_SUBMIT",
        "equals": { "mismatch": false }
      },
      "action": {
        "ruleId": "FORM_ACTION_MATCH",
        "scoreDelta": 5,
        "severity": "LOW"
      }
    },
    {
      "id": "FORM_ACTION_PARSE_FAIL",
      "enabled": true,
      "when": {
        "type": "FORM_SUBMIT",
        "equals": { "parse": "fail" }
      },
      "action": {
        "ruleId": "FORM_ACTION_PARSE_FAIL",
        "scoreDelta": 10,
        "severity": "MEDIUM",
        "targetOrigin": "UNKNOWN"
      }
    },

    {
      "id": "OBFUSCATION_ATOB",
      "enabled": true,
      "when": { "type": "SUSP_ATOB_CALL" },
      "action": {
        "ruleId": "OBFUSCATION_ATOB",
        "scoreDelta": 10,
        "severity": "LOW"
      }
    },
    {
      "id": "DYNAMIC_CODE_EVAL",
      "enabled": true,
      "when": { "type": "SUSP_EVAL_CALL" },
      "action": {
        "ruleId": "DYNAMIC_CODE_EVAL",
        "scoreDelta": 25,
        "severity": "MEDIUM"
      }
    },
    {
      "id": "DYNAMIC_CODE_FUNCTION",
      "enabled": true,
      "when": { "type": "SUSP_FUNCTION_CONSTRUCTOR_CALL" },
      "action": {
        "ruleId": "DYNAMIC_CODE_FUNCTION",
        "scoreDelta": 25,
        "severity": "MEDIUM"
      }
    },

    {
      "id": "DOM_XSS_INJECTION",
      "enabled": true,
      "when": { "type": "SUSP_DOM_XSS" },
      "action": {
        "ruleId": "DOM_XSS_INJECTION",
        "scoreDelta": 40,
        "severity": "HIGH"
      }
    },
    {
      "id": "COOKIE_THEFT",
      "enabled": true,
      "when": { "type": "SENSITIVE_DATA_ACCESS" },
      "action": {
        "ruleId": "COOKIE_THEFT",
        "scoreDelta": 50,
        "severity": "HIGH"
      }
    },
    {
      "id": "NETWORK_LEAK",
      "enabled": true,
      "when": { "type": "SUSP_NETWORK_CALL" },
      "action": {
        "ruleId": "NETWORK_LEAK",
        "scoreDelta": 15,
        "severity": "LOW"
      }
    }
  ]
}
